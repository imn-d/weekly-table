"use strict";(self.webpackChunkweekly_table=self.webpackChunkweekly_table||[]).push([[733],{733:function(e,t,i){i.r(t),i.d(t,{default:function(){return q},schedulerColumns:function(){return s},schedulerRows:function(){return n}});const s=[{weight:1,full:"Monday",short:"Mon"},{weight:2,full:"Tuesday",short:"Tue"},{weight:4,full:"Wednesday",short:"Wed"},{weight:8,full:"Thursday",short:"Thu"},{weight:16,full:"Friday",short:"Fri"},{weight:32,full:"Saturday",short:"Sat"},{weight:64,full:"Sunday",short:"Sun"}],n=["01:00","04:00","07:00","10:00","13:00","17:00","20:00","23:00"],o=864e5;var r=i(893),l=i(294);const a=(0,l.createContext)({}),c=()=>(0,l.useContext)(a);var d=({children:e})=>{var t,i;const{parentRef:s,timeframe:n,columns:c,helperWidthProp:d,headerHeightProp:u,bottomHeightProp:m}=Z(),[h,p]=(0,l.useState)({}),g=(0,l.useCallback)((e=>{p(Object.assign(Object.assign({},h),{cells:e}))}),[h]),f=(0,l.useMemo)((()=>60*n*1e3),[n]);return(0,l.useEffect)((()=>{const e=null==s?void 0:s.current;if(!e)return;const t=(e.offsetWidth-d)/(null==c?void 0:c.length),i=e.offsetHeight-u-m,r=i/(1440/n),l=o/i,a=i/r-1,h=new Array;let g=d;for(let e=0;e<(null==c?void 0:c.length);e++){let s=u;for(let n=0;n<i/r;n++)h.push({isSelected:!1,column:e,row:n,position:{x:g,y:s,w:g+t,h:s+r}}),s+=r;g+=t}p({widthStep:t,heightStep:r,millisPerPixel:l,cells:h,maxCellIndex:a,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight})}),[null===(t=null==s?void 0:s.current)||void 0===t?void 0:t.offsetWidth,null===(i=null==s?void 0:s.current)||void 0===i?void 0:i.offsetHeight,null==c?void 0:c.length,m,u,d,n,s]),(0,r.jsx)(a.Provider,Object.assign({value:Object.assign(Object.assign({},h),{setCells:g,msTime:f})},{children:e}),void 0)};const u=(0,l.createContext)({}),m=()=>(0,l.useContext)(u);var h=({children:e})=>{const{headerHeightProp:t,helperWidthProp:i,bottomHeightProp:s}=Z(),{offsetWidth:n,offsetHeight:o,cells:a,setCells:d}=c(),[m,h]=(0,l.useState)(!1),p=(0,l.useRef)(null),g=(0,l.useRef)(null),[f,v]=(0,l.useState)([0,0]),[T,b]=(0,l.useState)(void 0),[x,j]=(0,l.useState)(void 0);(0,l.useEffect)((()=>{const e=p.current;if(!e)return;e.width=2*n,e.height=2*o,e.style.width=`${n}px`,e.style.height=`${o}px`,e.draggable=!1;const t=e.getContext("2d");t&&(t.scale(2,2),t.lineCap="round",t.strokeStyle="blue",t.lineWidth=1,t.fillStyle="#0000FF19",g.current=t)}),[o,n]);const w=(0,l.useCallback)((({nativeEvent:e})=>{const{offsetX:t,offsetY:i}=e;g.current&&(g.current.beginPath(),g.current.moveTo(t,i),h(!0),v([t,i]),b(void 0))}),[]),O=(0,l.useCallback)((()=>{g.current&&g.current.clearRect(0,0,n,o)}),[o,n]),k=(0,l.useCallback)((({nativeEvent:e})=>{g.current&&m&&(g.current.closePath(),h(!1),b([e.offsetX,e.offsetY]),j(void 0),O())}),[m]),y=(0,l.useCallback)((({nativeEvent:e})=>{m&&g.current&&(j([e.offsetX,e.offsetY]),g.current.clearRect(0,0,n,o),g.current.strokeRect(f[0],f[1],e.offsetX-f[0],e.offsetY-f[1]),g.current.fillRect(f[0]+1,f[1]+1,e.offsetX-f[0]-1,e.offsetY-f[1]-1))}),[m,o,n,f]),S=(0,l.useCallback)((e=>e&&a?(e[0]>=n-5&&(e[0]=n-5),e[0]<=i&&(e[0]=i),e[1]<=t&&(e[1]=t),e[1]>=o-s&&(e[1]=o-s-1),a.findIndex((t=>t.position.x<=e[0]&&e[0]<=t.position.w&&t.position.y<=e[1]&&e[1]<=t.position.h))):-1),[n,a,i,t,o,s]);return(0,l.useEffect)((()=>{if(void 0===T&&void 0===x)return;const e=S(f);if(-1===e)return;const t=S(void 0===x?T:x);if(-1===t)return;const i=a[e],s=a[t],n=i.row<s.row?i.row:s.row,o=i.column<s.column?i.column:s.column,r=s.row>i.row?s.row:i.row,l=s.column>i.column?s.column:i.column,c=a.map((e=>e.row>=n&&e.row<=r&&e.column>=o&&e.column<=l?Object.assign(Object.assign({},e),{isSelected:!0}):e));d(c)}),[f,T,x]),(0,r.jsx)(u.Provider,Object.assign({value:{canvasRef:p,startDrawing:w,finishDrawing:k,draw:y,isDrawing:m}},{children:e}),void 0)},p=i(597),g=i.n(p);const f=(0,l.createContext)({}),v=()=>(0,l.useContext)(f);var T=({children:e})=>{const t=(0,l.useRef)(null),i=(0,l.useRef)(null),s=(0,l.useRef)(null),[n,o]=(0,l.useState)(!1),[a,c]=(0,l.useState)(0),[d,u]=(0,l.useState)(2),m=(0,l.useCallback)((e=>{if(t.current&&i.current&&s.current)switch(u(e),o(!0),e){case 2:t.current.requestPointerLock();break;case 1:s.current.requestPointerLock();break;case 0:i.current.requestPointerLock();break;default:o(!1)}}),[]),h=(0,l.useCallback)((()=>{o(!1),document.exitPointerLock()}),[]),p=(0,l.useCallback)((({nativeEvent:e})=>{if(!n)return;const{movementY:t}=e;c(t)}),[n]);return(0,r.jsx)(f.Provider,Object.assign({value:{draw:p,moveRef:t,resBotRef:s,resTopRef:i,isLocking:n,movement:a,startDrawing:m,finishDrawing:h,action:d}},{children:e}),void 0)};const b=(0,l.createContext)({}),x=()=>(0,l.useContext)(b);var j=({children:e})=>{const{columns:t,defaultValue:i,onChange:s,helperWidthProp:n,headerHeightProp:a,requiredTZOffset:d}=Z(),{cells:u,setCells:h,widthStep:p,msTime:f,maxCellIndex:T,millisPerPixel:x}=c(),{isDrawing:j}=m(),{isLocking:w}=v(),[O,k]=(0,l.useState)([]),[y,S]=(0,l.useState)([]),[C,E]=(0,l.useState)([]),P=(0,l.useCallback)((e=>{E(C.concat([e]))}),[C]),M=(0,l.useCallback)((()=>{C.length<2||(k(C[C.length-2]),E([...C.slice(0,C.length-1)]))}),[C]),L=(0,l.useMemo)((()=>60*(new Date).getTimezoneOffset()*1e3),[]),[I,H]=(0,l.useState)(L);(0,l.useEffect)((()=>{H(d||0===d?d:L)}),[L,d]);const R=(0,l.useCallback)(((e,t)=>{var i;if(e.endTime-e.startTime<f)return;const s=O.filter((t=>t.id!==e.id));let n=Math.abs(Math.round(e.startTime/f));n<0&&(n=0);const o=u.filter((e=>e.row===n))[0];let r=null===(i=null==o?void 0:o.position)||void 0===i?void 0:i.y;r||(r=u[T].position.h);const l=Object.assign(Object.assign({},e),{realStartTime:e.startTime,realEndTime:e.endTime,top:r,height:t?e.height-(r-e.top):e.height});k(s.concat(l)),P(s.concat(l))}),[O,f,u,T]),D=(0,l.useCallback)((e=>{var t;if(e.endTime-e.startTime<f)return;const i=O.filter((t=>t.id!==e.id)),s=Math.abs(Math.round(e.endTime/f)),n=u.find((e=>e.row===s));let o=null===(t=null==n?void 0:n.position)||void 0===t?void 0:t.y;o||(o=u[T].position.h);const r=Object.assign(Object.assign({},e),{realStartTime:e.startTime,realEndTime:e.endTime,height:o-e.top});k(i.concat(r)),P(i.concat(r))}),[O,u,T,f]);return(0,l.useEffect)((()=>{j||w||O.length<2||[...new Set(O.map((e=>e.column)))].forEach((e=>{const t=O.filter((t=>t.column===e));if(t.length<2)return;const i=t.sort(((e,t)=>e.top<=t.top?-1:1));for(let t=0;t<i.length-1;t++){const s=i[t],n=i[t+1],o=s.top+s.height,r=n.top+n.height,l=O.filter((e=>e.id!==s.id&&e.id!==n.id));if(o<=r+1&&o>=n.top-1){const t={id:g().generate(),startTime:s.startTime,endTime:n.endTime,width:s.width,height:n.top-s.top+n.height,top:s.top,left:s.left,column:e,isTemp:!1,realStartTime:s.startTime,realEndTime:n.endTime};k(l.concat(t));break}if(n.top<=o&&n.top>=s.top){const e=Object.assign(Object.assign({},s),{id:g().generate()});k(l.concat(e));break}}}))}),[O,j,w]),(0,l.useEffect)((()=>{if(!u)return;const e=u.filter((e=>e.isSelected));if(0===e.length)return;const t=[...new Set(e.map((e=>e.column)))].map((t=>{const i=e.filter((e=>e.column===t)),s=i[0],n=i[i.length-1],o=s.row*f,r=(n.row+1)*f;return{id:g().generate(),startTime:o,endTime:r,width:.75*p,height:n.position.h-s.position.y,top:s.position.y,left:s.position.x+5,column:t,isTemp:j,realStartTime:o,realEndTime:r}}));j?S(O.concat(t)):(k(O.concat(t)),P(O.concat(t)),S([])),h(u.map((e=>Object.assign(Object.assign({},e),{isSelected:!1}))))}),[O,u,j,y,f,p]),(0,l.useEffect)((()=>{if(!i||!p||!n)return;const e=((e,t)=>{const i=[];return e.forEach((e=>{if(e.endTime>864e5){const s=e.column+1>=t?0:e.column+1,n=e.endTime-o,r=e.startTime-o;return r>0?void i.push(Object.assign(Object.assign({},e),{startTime:r,endTime:n,realStartTime:r,realEndTime:n,column:s})):(e.startTime<o&&i.push(Object.assign(Object.assign({},e),{startTime:e.startTime,endTime:o,realStartTime:e.startTime,realEndTime:o,column:e.column})),void i.push(Object.assign(Object.assign({},e),{startTime:0,endTime:n,realStartTime:0,realEndTime:n,column:s})))}if(e.startTime<0){const s=e.column-1<0?t-1:e.column-1,n=o+e.startTime,r=o+e.endTime;if(r<o)return void i.push(Object.assign(Object.assign({},e),{startTime:n,endTime:r,realStartTime:n,realEndTime:r,column:s}));i.push(Object.assign(Object.assign({},e),{startTime:n,endTime:o,realStartTime:n,realEndTime:o,column:s}));const l=o-(o-e.endTime);0!==l&&i.push(Object.assign(Object.assign({},e),{startTime:0,endTime:l,realStartTime:0,realEndTime:l,column:e.column}))}else i.push(Object.assign({},e))})),i})(((e,t,i)=>{const s=[];return e.forEach((e=>{let n=e.mask.toString(2);n.length<t&&(n="0".repeat(t-n.length).concat(n));const o=[...n].reverse(),r=e.startTime-i,l=e.endTime-i;for(let e=0;e<o.length;e++)"0"!==o[e]&&s.push({startTime:r,endTime:l,column:e})})),s})(i,t.length,I),t.length),s=e.map((e=>Object.assign(Object.assign({},e),{id:g().generate(),realStartTime:e.startTime,realEndTime:e.endTime,top:e.startTime/x+a,left:p*e.column+5+n,width:.75*p,height:(e.endTime-e.startTime)/x,isTemp:!1})));k(s),P(s)}),[null==t?void 0:t.length,i,a,n,x,I,p]),(0,l.useEffect)((()=>{if(!s)return;const e=((e,t)=>{const i=new Array;for(let s=0;s<t.length;s++){const n=t[s].weight,o=e.filter((e=>e.column===n)).sort(((e,t)=>e.startTime<=t.startTime?-1:1));for(let e=0;e<o.length;e++){const t=o[e],s=o[e+1];if(!s){i.push(t);break}if(t.endTime!==s.startTime){i.push(t);continue}const n=Object.assign(Object.assign({},t),{endTime:s.endTime,realEndTime:s.realEndTime});i.push(n),e+=1}}return i})(((e,t,i)=>{const s=new Array;return e.forEach((e=>{const n=e.startTime+t,r=e.endTime+t,l=i[e.column].weight;if(n<0){const t=e.column-1<0?i.length-1:e.column-1,a=i[t].weight,c=o+n,d=o+r;if(d<o)return void s.push(Object.assign(Object.assign({},e),{startTime:c,endTime:d,realStartTime:c,realEndTime:d,column:a}));s.push(Object.assign(Object.assign({},e),{startTime:c,endTime:o,realStartTime:c,realEndTime:o,column:a}));const u=o-(o-r);0!==u&&s.push(Object.assign(Object.assign({},e),{startTime:0,endTime:u,realStartTime:0,realEndTime:u,column:l}))}else{if(r>o){const t=e.column+1>=i.length?0:e.column+1,a=i[t].weight,c=r-o,d=n-o;return d>0?void s.push(Object.assign(Object.assign({},e),{startTime:d,endTime:c,realStartTime:d,realEndTime:c,column:a})):(n!==o&&s.push(Object.assign(Object.assign({},e),{startTime:n,endTime:o,realStartTime:n,realEndTime:o,column:l})),void s.push(Object.assign(Object.assign({},e),{startTime:0,endTime:c,realStartTime:0,realEndTime:c,column:a})))}s.push(Object.assign(Object.assign({},e),{startTime:n,endTime:r,realStartTime:n,realEndTime:r,column:l}))}})),s})(O,I,t),t),i=new Array;e.forEach((e=>{i.find((t=>t.startTime===e.startTime&&t.endTime===e.endTime))||i.push({startTime:e.startTime,endTime:e.endTime})}));const n=i.map((t=>{const i=e.filter((e=>e.startTime===t.startTime&&e.endTime===t.endTime)).reduce(((e,t)=>e+t.column),0);return{startTime:t.startTime,endTime:t.endTime,mask:i}}));s(n)}),[O,t,I]),(0,r.jsx)(b.Provider,Object.assign({value:{undoHistory:M,blocks:O,setTopPosition:R,preview:y,setBotPosition:D,setBlocks:k,handleHistory:P}},{children:e}),void 0)};const w=(0,l.createContext)({}),O=()=>(0,l.useContext)(w);var k=({children:e})=>{const{millisPerPixel:t}=c(),{blocks:i,setBlocks:s}=x(),[n,a]=(0,l.useState)({}),[d,u]=(0,l.useState)(),[m,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(),[f,v]=(0,l.useState)(void 0),[T,b]=(0,l.useState)({startTime:"00:00:00",endTime:"00:00:00"}),j=(0,l.useCallback)((e=>{g(e),u({top:e.height>20?e.height+e.top+5:e.top+25,left:e.left}),a({startTime:e.startTime,endTime:e.endTime}),b({startTime:new Date(e.startTime).toISOString().substr(11,8),endTime:new Date(e.endTime).toISOString().substr(11,8)})}),[]),O=(0,l.useCallback)(((e,t)=>{null!=e?(isNaN(e)&&(e=0),v(void 0),true===t?(a(Object.assign(Object.assign({},n),{startTime:e})),b(Object.assign(Object.assign({},T),{startTime:new Date(e).toISOString().substr(11,8)}))):(a(Object.assign(Object.assign({},n),{endTime:0===e?o:e})),b(Object.assign(Object.assign({},T),{endTime:new Date(e).toISOString().substr(11,8)})))):v("Time is null")}),[T,n]),k=(0,l.useCallback)((()=>{p&&(a({startTime:p.startTime,endTime:p.endTime}),b({startTime:new Date(p.startTime).toISOString().substr(11,8),endTime:new Date(p.endTime).toISOString().substr(11,8)}),v(void 0))}),[p]),y=(0,l.useCallback)((()=>{if(!p)return!0;const e=i.filter((e=>e.id!==p.id));if(n.endTime-n.startTime<6e4)return v("Range < 1 min"),!0;const o=-(p.startTime-n.startTime)/t,r=-(p.endTime-n.endTime)/t,l=Object.assign(Object.assign({},p),{startTime:n.startTime,endTime:n.endTime,realStartTime:n.startTime,realEndTime:n.endTime,top:p.top+o,height:p.height+r-o});return s(e.concat(l)),!1}),[i,t,p,n.endTime,n.startTime]);return(0,r.jsx)(w.Provider,Object.assign({value:{isEditing:m,resetTime:k,setEditing:h,handleTime:O,updateBlock:y,position:d,handleObject:j,displayTime:T,isError:f}},{children:e}),void 0)};const y=(0,l.createContext)({}),S=()=>(0,l.useContext)(y);var C=({children:e})=>{const{blocks:t,setBlocks:i,handleHistory:s,undoHistory:n}=x(),{millisPerPixel:a,msTime:d}=c(),{isLocking:u,movement:m,action:h}=v(),[p,g]=(0,l.useState)(void 0),[f,T]=(0,l.useState)({code:"",ctrl:!1});(0,l.useEffect)((()=>(document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)})),[]);const b=(0,l.useCallback)((e=>{e.code&&T({code:e.code,ctrl:e.ctrlKey})}),[]);(0,l.useEffect)((()=>{if("Delete"===f.code||"Backspace"===f.code)return(null==p?void 0:p.id)&&k(p.id),void T({code:"",ctrl:!1});"KeyZ"===f.code&&f.ctrl&&(n(),T({code:"",ctrl:!1}))}),[f.code,f.ctrl,null==p?void 0:p.id]);const j=(0,l.useCallback)((e=>{const i=t.find((t=>t.id===e));i&&g({id:i.id,block:i})}),[t]),w=(0,l.useCallback)((()=>{g(void 0)}),[]),O=(0,l.useMemo)((()=>!(null==p?void 0:p.block)||p.block.endTime-p.block.startTime>=d),[d,null==p?void 0:p.block]),k=(0,l.useCallback)((e=>{i([...t].filter((t=>t.id!==e))),s([...t].filter((t=>t.id!==e))),g(void 0)}),[t]),S=(0,l.useCallback)(((e,s)=>{const n=e.top,r=n+s,l=[...t].filter((t=>t.id!==e.id)),c=(r-n)*a,u=e.realStartTime+c,m=e.realEndTime+c;if(u<-d/3||m>o+d/3||m-u<d)return;const h=Math.abs(Math.round(e.realStartTime/d)*d),p=Math.round(e.realEndTime/d)*d,g=Object.assign(Object.assign({},e),{startTime:h,endTime:p,realStartTime:u,realEndTime:m,top:r});i(l.concat(g))}),[t,a,i,d]),C=(0,l.useCallback)(((e,s,n)=>{const r=t.filter((t=>t.id!==e.id));if(false!==n){if(true===n){const t=e.height,n=t+s,l=(n-t)*a,c=e.realEndTime+l;if(c>o+d/3)return;if(c-e.realStartTime<d)return;let u=Math.round(e.realEndTime/d)*d;u>o&&(u=o);const m=Object.assign(Object.assign({},e),{endTime:u,realEndTime:c,height:n});i(r.concat(m))}}else{const t=e.top,n=t+s,o=(n-t)*a,l=e.realStartTime+o;if(l<-d/3)return;if(e.realEndTime-l<d)return;const c=Math.abs(Math.round(e.realStartTime/d)*d),u=Object.assign(Object.assign({},e),{startTime:c,realStartTime:l,top:n,height:e.height+t-n});i(r.concat(u))}}),[t,a,d]);return(0,l.useEffect)((()=>{if(u&&(null==p?void 0:p.block)&&0!==m)switch(h){case 2:return void S(p.block,m);case 0:return void C(p.block,m,false);case 1:return void C(p.block,m,true);default:return}}),[h,u,m,null==p?void 0:p.block]),(0,r.jsx)(y.Provider,Object.assign({value:{isAllowing:O,popup:p,hidePopup:w,deleteBlock:k,showPopup:j}},{children:e}),void 0)};const E=(0,l.memo)((()=>{const{helperWidthProp:e,headerHeightProp:t,baseZIndex:i,bottomHeightProp:s}=Z(),{widthStep:n,heightStep:o,offsetHeight:a,offsetWidth:d}=c(),u=(0,l.useRef)(null),m=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const i=null==u?void 0:u.current;if(!i)return;i.width=2*d,i.height=2*a,i.style.width=`${d}px`,i.style.height=`${a}px`;const r=i.getContext("2d");if(r){r.scale(2,2),m.current=r,m.current.beginPath();for(let t=e;t<=d;t+=n)m.current.moveTo(t,0),m.current.lineTo(t,a-s);m.current.strokeStyle="rgba(0,0,0, 0.2)",m.current.lineWidth=1,m.current.stroke(),m.current.beginPath();for(let i=t;i<=a-s;i+=o)m.current.moveTo(e,i),m.current.lineTo(d,i);m.current.strokeStyle="rgba(0,0,0, 0.1)",m.current.lineWidth=1,m.current.stroke(),m.current.save()}}),[s,t,o,e,a,d,n]),(0,r.jsx)("canvas",{id:"backgroundCanvas",className:"scheduler-background-canvas",style:{position:"absolute",zIndex:i+1},ref:u},void 0)})),P=(0,l.memo)((()=>(0,r.jsx)("svg",Object.assign({id:"cancelIcon",className:"scheduler-icon cancel-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"24",height:"24",viewBox:"0 0 64 64"},{children:(0,r.jsx)("path",{d:"M 12 8 L 8 12 L 24.666016 32 L 8 52 L 12 56 L 32 39.333984 L 52 56 L 56 52 L 39.333984 32 L 56 12 L 52 8 L 32 24.666016 L 12 8 z"},void 0)}),void 0))),M=(0,l.memo)((()=>(0,r.jsx)("svg",Object.assign({id:"deleteIcon",className:"scheduler-icon delete-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:25,height:25,viewBox:"0 0 30 30"},{children:(0,r.jsx)("path",{d:"M 13 3 A 1.0001 1.0001 0 0 0 11.986328 4 L 6 4 A 1.0001 1.0001 0 1 0 6 6 L 24 6 A 1.0001 1.0001 0 1 0 24 4 L 18.013672 4 A 1.0001 1.0001 0 0 0 17 3 L 13 3 z M 6 8 L 6 24 C 6 25.105 6.895 26 8 26 L 22 26 C 23.105 26 24 25.105 24 24 L 24 8 L 6 8 z"},void 0)}),void 0))),L=(0,l.memo)((()=>(0,r.jsx)("svg",Object.assign({id:"editIcon",className:"scheduler-icon edit-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:25,height:25,viewBox:"0 0 25 25"},{children:(0,r.jsx)("path",{d:"M 18.414062 2 C 18.158188 2 17.902031 2.0974687 17.707031 2.2929688 L 16 4 L 20 8 L 21.707031 6.2929688 C 22.098031 5.9019687 22.098031 5.2689063 21.707031 4.8789062 L 19.121094 2.2929688 C 18.925594 2.0974687 18.669937 2 18.414062 2 z M 14.5 5.5 L 3 17 L 3 21 L 7 21 L 18.5 9.5 L 14.5 5.5 z"},void 0)}),void 0))),I=(0,l.memo)((()=>(0,r.jsx)("svg",Object.assign({id:"dragIcon",className:"scheduler-icon drag-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:25,height:25,viewBox:"0 0 25 25"},{children:(0,r.jsx)("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"},void 0)}),void 0))),H=(0,l.memo)((()=>(0,r.jsx)("svg",Object.assign({id:"checkIcon",className:"scheduler-icon check-icon",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"24",height:"24",viewBox:"0 0 64 64"},{children:(0,r.jsx)("path",{d:"M27 55L6 33 9 29 26 41 55 12 59 16z"},void 0)}),void 0))),R=()=>{const{baseZIndex:e}=Z(),{widthStep:t,heightStep:i}=c(),{setTopPosition:s,setBotPosition:n}=x(),{popup:o,showPopup:l,hidePopup:a,deleteBlock:d,isAllowing:u}=S(),{isEditing:h,setEditing:p,updateBlock:g,resetTime:f}=O(),{moveRef:T,resBotRef:b,resTopRef:j,startDrawing:w,finishDrawing:k,draw:y,isLocking:C}=v(),{isDrawing:E}=m();return o?(0,r.jsxs)("div",Object.assign({id:"popupWrapper",className:"scheduler-popup-wrapper",style:{zIndex:E?e+2:e+5,position:"absolute",top:o.block.top-35,left:o.block.left-15,boxSizing:"border-box",display:"grid",gridTemplateColumns:`15px ${.75*t}px 30px`,gridTemplateRows:`33px ${o.block.height<i?i:o.block.height+3}px 33px `,width:.75*t+45,maxWidth:.75*t+45},onMouseEnter:()=>l(o.id),onMouseMove:()=>C?l(o.id):null,onMouseLeave:()=>(h||(a(),k()),null)},{children:[(0,r.jsx)("div",{style:{gridColumn:" 1",gridRow:"1 / 4"}},void 0),(0,r.jsx)("div",Object.assign({id:"popupTop",className:"scheduler-popup scheduler-popup-top",style:{gridColumn:"2",gridRow:"1",display:h||!u?"none":"flex",cursor:"n-resize",justifyContent:"center",alignItems:"self-end"},ref:j,onMouseMove:y,onMouseDown:()=>w(0),onMouseUp:()=>{k(),s(o.block,!0)}},{children:(0,r.jsx)(I,{},void 0)}),void 0),(0,r.jsxs)("div",Object.assign({id:"popupRight",className:"scheduler-popup scheduler-popup-right",style:{gridColumn:" 3",gridRow:"1 / 4",display:C?"none":"flex",flexDirection:"column",alignItems:"center",justifyContent:h?"center":"space-around"}},{children:[h?(0,r.jsx)("div",Object.assign({id:"popupCheckIcon",className:"popup-check-icon",style:{cursor:"pointer"},onClick:()=>p(g())},{children:(0,r.jsx)(H,{},void 0)}),void 0):(0,r.jsx)(r.Fragment,{},void 0),(0,r.jsx)("div",Object.assign({id:"popupCEIcon",className:"popup-cancel-edit-icon",style:{cursor:"pointer"},onClick:()=>{p((e=>!e)),f()}},{children:h?(0,r.jsx)(P,{},void 0):(0,r.jsx)(L,{},void 0)}),void 0),(0,r.jsx)("div",Object.assign({id:"popupDeleteIcon",className:"popup-delete-icon",style:{cursor:"pointer",display:h?"none":"block"},onClick:()=>d(o.id)},{children:(0,r.jsx)(M,{},void 0)}),void 0)]}),void 0),(0,r.jsx)("div",{id:"popupCenter",className:"scheduler-popup scheduler-popup-center",style:{gridColumn:"2",gridRow:"2",cursor:"grab",display:h||!u?"none":"block"},ref:T,onMouseMove:y,onMouseDown:()=>w(2),onMouseUp:()=>{k(),s(o.block,!1)}},void 0),(0,r.jsx)("div",Object.assign({id:"popupBot",className:"scheduler-popup scheduler-popup-bot",style:{gridColumn:"2",gridRow:"3",cursor:"n-resize",display:h||!u?"none":"flex",justifyContent:"center",alignItems:"self-start"},ref:b,onMouseMove:y,onMouseDown:()=>w(1),onMouseUp:()=>{k(),n(o.block)}},{children:(0,r.jsx)(I,{},void 0)}),void 0)]}),void 0):null};const D=e=>{var t=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}(e,[]);const{baseZIndex:i,blockColors:s}=Z(),{isDrawing:n}=m(),{popup:a,showPopup:c,hidePopup:d}=S(),{isEditing:u,handleObject:h}=O(),p=(0,l.useMemo)((()=>(null==a?void 0:a.id)===t.id?s.hover:t.isTemp?s.temp:n?s.draw:s.common),[t.id,t.isTemp,s.common,s.draw,s.hover,s.temp,n,null==a?void 0:a.id]),g=(0,l.useCallback)((()=>{if(u)return null;c(t.id),h(t)}),[t,u]),f=(0,l.useMemo)((()=>t.endTime===o?"24:00":new Date(t.endTime).toISOString().substr(11,5)),[t.endTime]);return(0,r.jsx)("div",Object.assign({id:"timeBlock",className:"scheduler-time-block",style:{zIndex:n?i:i+4,position:"absolute",top:t.top,left:t.left,width:t.width,height:t.height,backgroundColor:p},onMouseEnter:g,onMouseMove:g,onMouseLeave:()=>u?null:d()},{children:(0,r.jsx)("span",Object.assign({id:"timeDisplay",className:"scheduler-text scheduler-time-display",style:{userSelect:"none",pointerEvents:"none"}},{children:new Date(t.startTime).toISOString().substr(11,5)+" / "+f}),void 0)}),void 0)},N=()=>{const{baseZIndex:e}=Z(),{widthStep:t}=c(),{isEditing:i,position:s,displayTime:n,handleTime:o,isError:l}=O();return(0,r.jsxs)("div",Object.assign({id:"customTimeWrapper",className:"scheduler-text custom-time-wrapper",style:{display:i?"flex":"none",zIndex:e+6,position:"absolute",flexDirection:"column",top:null==s?void 0:s.top,left:null==s?void 0:s.left,width:t?.75*t:0,maxWidth:t?.75*t:0}},{children:[l?(0,r.jsx)("span",Object.assign({id:"customTimeError",className:"custom-time-error",style:{position:"absolute",top:55,width:t}},{children:l}),void 0):(0,r.jsx)(r.Fragment,{},void 0),(0,r.jsx)("input",{id:"customTimeInputStart",className:"custom-time-input custom-time-input-start",style:{width:t?.75*t:0,maxWidth:t?.75*t:0},type:"time",value:n.startTime,step:1,onChange:e=>{var t;return o(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.valueAsNumber,true)}},void 0),(0,r.jsx)("input",{id:"customTimeInputEnd",className:"custom-time-input custom-time-input-end",style:{width:t?.75*t:0,maxWidth:t?.75*t:0},type:"time",value:n.endTime,step:1,onChange:e=>{var t;return o(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.valueAsNumber,false)}},void 0)]}),void 0)},W=()=>{const{baseZIndex:e}=Z(),{startDrawing:t,finishDrawing:i,draw:s,canvasRef:n,isDrawing:o}=m(),{blocks:a}=x(),{hidePopup:c}=S(),{isLocking:d}=v(),{isEditing:u}=O();return(0,l.useEffect)((()=>{o||d||u||c()}),[o,a,d,u]),(0,r.jsx)("canvas",{id:"schedulerArea",className:"scheduler-area",style:{position:"absolute",zIndex:e+3,cursor:"crosshair"},onMouseDown:e=>u?null:t(e),onMouseUp:i,onMouseMove:s,onMouseLeave:i,ref:n},void 0)},B=()=>{const{widthStep:e}=c(),{headerHeightProp:t,columns:i}=Z();return(0,r.jsx)("div",Object.assign({id:"schedulerHeader",className:"scheduler-header",style:{position:"relative",userSelect:"none",display:"inline-flex",height:`${t}px`,maxHeight:`${t}px`}},{children:null==i?void 0:i.map((t=>(0,r.jsx)("div",Object.assign({id:"schedulerHeaderColumn",className:"scheduler-text scheduler-header-column",style:{display:"inline-flex",minWidth:`${e}px`,width:`${e}px`}},{children:t.full}),t.weight)))}),void 0)},$=()=>{const{helperWidthProp:e,rows:t,headerHeightProp:i,bottomHeightProp:s}=Z(),{offsetHeight:n}=c(),o=(0,l.useMemo)((()=>(n-i-s)/(null==t?void 0:t.length)),[s,i,n,null==t?void 0:t.length]);return(0,r.jsx)("div",Object.assign({id:"schedulerHelper",className:"scheduler-helper",style:{display:"inline-flex",flexDirection:"column",position:"relative",width:`${e}px`,maxWidth:`${e}px`,userSelect:"none"}},{children:null==t?void 0:t.map(((e,t)=>(0,r.jsx)("div",Object.assign({id:"schedulerHelperRow",className:"scheduler-text scheduler-helper-row",style:{display:"inline-flex",minHeight:`${o}px`,height:`${o}px`}},{children:e}),t)))}),void 0)},z=()=>{const{headerHeightProp:e,helperWidthProp:t,bottomHeightProp:i,baseZIndex:s}=Z(),{offsetWidth:n,offsetHeight:o}=c(),{blocks:l,preview:a}=x();return(0,r.jsxs)("div",Object.assign({id:"schedulerLayout",className:"scheduler-layout",style:{position:"absolute",display:"grid",gridTemplateColumns:`${t}px ${n-t}px`,gridTemplateRows:`${e}px ${o-e-i}px ${i}px`,width:n,maxWidth:n,height:o,maxHeight:o,zIndex:s+2}},{children:[null==l?void 0:l.map((e=>(0,r.jsx)(D,Object.assign({},e),e.id))),null==a?void 0:a.map((e=>(0,r.jsx)(D,Object.assign({},e),e.id))),(0,r.jsx)("div",{style:{position:"relative"}},void 0),(0,r.jsx)(B,{},void 0),(0,r.jsx)($,{},void 0),(0,r.jsx)(W,{},void 0)]}),void 0)},A=(0,l.createContext)({}),Z=()=>(0,l.useContext)(A);var q=e=>(0,r.jsx)(A.Provider,Object.assign({value:{parentRef:e.parentRef,blockColors:(null==e?void 0:e.blockColors)?e.blockColors:{common:"#ff5722",temp:"#c6a700",draw:"#ff8a50",hover:"#ff3d00"},headerHeightProp:(null==e?void 0:e.headerHeightProp)?e.headerHeightProp:80,helperWidthProp:(null==e?void 0:e.helperWidthProp)?e.helperWidthProp:80,bottomHeightProp:(null==e?void 0:e.bottomHeightProp)?e.bottomHeightProp:20,baseZIndex:(null==e?void 0:e.baseZIndex)?e.baseZIndex:0,timeframe:(null==e?void 0:e.timeframe)?e.timeframe:60,columns:(null==e?void 0:e.columns)?e.columns:s,rows:(null==e?void 0:e.rows)?e.rows:n,requiredTZOffset:null==e?void 0:e.requiredTZOffset,defaultValue:null==e?void 0:e.defaultValue,onChange:null==e?void 0:e.onChange}},{children:(0,r.jsx)(d,{children:(0,r.jsx)(h,{children:(0,r.jsx)(T,{children:(0,r.jsx)(j,{children:(0,r.jsx)(C,{children:(0,r.jsxs)(k,{children:[(0,r.jsx)(E,{},void 0),(0,r.jsx)(z,{},void 0),(0,r.jsx)(R,{},void 0),(0,r.jsx)(N,{},void 0)]},void 0)},void 0)},void 0)},void 0)},void 0)},void 0)}),void 0)}}]);